- en: 5 Common Python Gotchas (And How To Avoid Them)
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 5 ä¸ªå¸¸è§çš„ Python é™·é˜±ï¼ˆä»¥åŠå¦‚ä½•é¿å…å®ƒä»¬ï¼‰
- en: åŸæ–‡ï¼š[https://www.kdnuggets.com/5-common-python-gotchas-and-how-to-avoid-them](https://www.kdnuggets.com/5-common-python-gotchas-and-how-to-avoid-them)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: åŸæ–‡ï¼š[https://www.kdnuggets.com/5-common-python-gotchas-and-how-to-avoid-them](https://www.kdnuggets.com/5-common-python-gotchas-and-how-to-avoid-them)
- en: '![5 Common Python Gotchas (And How To Avoid Them)](../Images/0dd7eeede41f544136175d06e3de1e51.png)'
  id: totrans-2
  prefs: []
  type: TYPE_IMG
  zh: '![5 ä¸ªå¸¸è§çš„ Python é™·é˜±ï¼ˆä»¥åŠå¦‚ä½•é¿å…å®ƒä»¬ï¼‰](../Images/0dd7eeede41f544136175d06e3de1e51.png)'
- en: Image by Author
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: ä½œè€…æä¾›çš„å›¾ç‰‡
- en: Python is a beginner-friendly and versatile programming language known for its
    simplicity and readability. Its elegant syntax, however, is not immune to quirks
    that can surprise even experienced Python developers. And understanding these
    is essential for writing bug-free codeâ€”or pain-free debugging if you will.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: Python æ˜¯ä¸€ç§å¯¹åˆå­¦è€…å‹å¥½ä¸”å¤šæ‰å¤šè‰ºçš„ç¼–ç¨‹è¯­è¨€ï¼Œä»¥å…¶ç®€æ´æ€§å’Œå¯è¯»æ€§è€Œé—»åã€‚ç„¶è€Œï¼Œå®ƒä¼˜é›…çš„è¯­æ³•å¹¶éæ²¡æœ‰å¥‡æ€ªä¹‹å¤„ï¼Œè¿™å¯èƒ½ä¼šè®©å³ä½¿æ˜¯ç»éªŒä¸°å¯Œçš„ Python
    å¼€å‘è€…æ„Ÿåˆ°æ„å¤–ã€‚ç†è§£è¿™äº›é—®é¢˜å¯¹äºç¼–å†™æ— é”™è¯¯çš„ä»£ç â€”â€”æˆ–è€…è¯´æ— ç—›è°ƒè¯•â€”â€”æ˜¯è‡³å…³é‡è¦çš„ã€‚
- en: '* * *'
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: '* * *'
- en: Our Top 3 Course Recommendations
  id: totrans-6
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬çš„ä¸‰å¤§è¯¾ç¨‹æ¨è
- en: '![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 1\. [Google Cybersecurity
    Certificate](https://www.kdnuggets.com/google-cybersecurity) - Get on the fast
    track to a career in cybersecurity.'
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: '![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 1\. [Google ç½‘ç»œå®‰å…¨è¯ä¹¦](https://www.kdnuggets.com/google-cybersecurity)
    - å¿«é€Ÿè¿›å…¥ç½‘ç»œå®‰å…¨èŒä¸šã€‚'
- en: '![](../Images/e225c49c3c91745821c8c0368bf04711.png) 2\. [Google Data Analytics
    Professional Certificate](https://www.kdnuggets.com/google-data-analytics) - Up
    your data analytics game'
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: '![](../Images/e225c49c3c91745821c8c0368bf04711.png) 2\. [Google æ•°æ®åˆ†æä¸“ä¸šè¯ä¹¦](https://www.kdnuggets.com/google-data-analytics)
    - æå‡ä½ çš„æ•°æ®åˆ†ææ°´å¹³'
- en: '![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 3\. [Google IT Support
    Professional Certificate](https://www.kdnuggets.com/google-itsupport) - Support
    your organization in IT'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: '![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 3\. [Google IT æ”¯æŒä¸“ä¸šè¯ä¹¦](https://www.kdnuggets.com/google-itsupport)
    - æ”¯æŒä½ ç»„ç»‡çš„ IT'
- en: '* * *'
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: '* * *'
- en: 'This tutorial explores some of these gotchas: mutable defaults, variable scope
    in loops and comprehensions, tuple assignment, and more. Weâ€™ll code simple examples
    to see *why* things work the way they do, and also look at *how* we can avoid
    these (if we actually can ğŸ™‚).'
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: æœ¬æ•™ç¨‹æ¢è®¨äº†ä¸€äº›è¿™äº›é—®é¢˜ï¼šå¯å˜çš„é»˜è®¤å€¼ã€å¾ªç¯å’Œæ¨å¯¼å¼ä¸­çš„å˜é‡ä½œç”¨åŸŸã€å…ƒç»„èµ‹å€¼ç­‰ã€‚æˆ‘ä»¬å°†ç¼–å†™ç®€å•çš„ç¤ºä¾‹æ¥äº†è§£*ä¸ºä»€ä¹ˆ*äº‹æƒ…ä¼šè¿™æ ·å·¥ä½œï¼Œå¹¶ä¸”è¿˜ä¼šç ”ç©¶*å¦‚ä½•*é¿å…è¿™äº›ï¼ˆå¦‚æœæˆ‘ä»¬çœŸçš„å¯ä»¥çš„è¯
    ğŸ™‚ï¼‰ã€‚
- en: So letâ€™s get started!
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: é‚£æˆ‘ä»¬å¼€å§‹å§ï¼
- en: 1\. Mutable Defaults
  id: totrans-13
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 1\. å¯å˜çš„é»˜è®¤å€¼
- en: In Python, mutable defaults are common sharp corners. Youâ€™ll run into unexpected
    behavior anytime you define a function with mutable objects, like lists or dictionaries,
    as default arguments.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨ Python ä¸­ï¼Œå¯å˜çš„é»˜è®¤å€¼å¸¸å¸¸æ˜¯ä¸ªæ£˜æ‰‹çš„é—®é¢˜ã€‚æ¯å½“ä½ å®šä¹‰ä¸€ä¸ªå¸¦æœ‰å¯å˜å¯¹è±¡ï¼ˆå¦‚åˆ—è¡¨æˆ–å­—å…¸ï¼‰ä½œä¸ºé»˜è®¤å‚æ•°çš„å‡½æ•°æ—¶ï¼Œä½ ä¼šé‡åˆ°æ„æƒ³ä¸åˆ°çš„è¡Œä¸ºã€‚
- en: '**The default value is evaluated only once, when the function is defined, and
    not each time the function is called**. This can lead to unexpected behavior if
    you mutate the default argument within the function.'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: '**é»˜è®¤å€¼ä»…åœ¨å‡½æ•°å®šä¹‰æ—¶è¯„ä¼°ä¸€æ¬¡ï¼Œè€Œä¸æ˜¯æ¯æ¬¡è°ƒç”¨å‡½æ•°æ—¶**ã€‚å¦‚æœä½ åœ¨å‡½æ•°å†…æ›´æ”¹é»˜è®¤å‚æ•°ï¼Œè¿™å¯èƒ½ä¼šå¯¼è‡´æ„æƒ³ä¸åˆ°çš„è¡Œä¸ºã€‚'
- en: 'Let''s take an example:'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªä¾‹å­ï¼š
- en: '[PRE0]'
  id: totrans-17
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: In this example, `add_to_cart` is a function that takes an item and appends
    it to a list `cart`. The default value of `cart` is an empty list. Meaning calling
    the function without an item to add returns an empty cart.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ`add_to_cart` æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒæ¥å—ä¸€ä¸ªé¡¹ç›®å¹¶å°†å…¶è¿½åŠ åˆ°ä¸€ä¸ªåˆ—è¡¨ `cart` ä¸­ã€‚`cart` çš„é»˜è®¤å€¼æ˜¯ä¸€ä¸ªç©ºåˆ—è¡¨ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœè°ƒç”¨å‡½æ•°æ—¶æ²¡æœ‰æ·»åŠ é¡¹ç›®ï¼Œå®ƒä¼šè¿”å›ä¸€ä¸ªç©ºè´­ç‰©è½¦ã€‚
- en: 'And here are a couple of function calls:'
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸‹é¢æ˜¯å‡ ä¸ªå‡½æ•°è°ƒç”¨ï¼š
- en: '[PRE1]'
  id: totrans-20
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: '[PRE2]'
  id: totrans-21
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: This works as expected. But what happens now?
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™æŒ‰é¢„æœŸå·¥ä½œã€‚ä½†ç°åœ¨ä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼Ÿ
- en: '[PRE3]'
  id: totrans-23
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: '[PRE4]'
  id: totrans-24
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: Because the default argument is a listâ€”a mutable objectâ€”it retains its state
    between function calls. So each time you call `add_to_cart`, it appends the value
    to the same list object created during the function definition. In this example,
    itâ€™s like all users sharing the same cart.
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: å› ä¸ºé»˜è®¤å‚æ•°æ˜¯ä¸€ä¸ªåˆ—è¡¨â€”â€”ä¸€ä¸ªå¯å˜å¯¹è±¡â€”â€”å®ƒåœ¨å‡½æ•°è°ƒç”¨ä¹‹é—´ä¿æŒå…¶çŠ¶æ€ã€‚æ‰€ä»¥æ¯æ¬¡è°ƒç”¨ `add_to_cart` æ—¶ï¼Œå®ƒéƒ½ä¼šå°†å€¼è¿½åŠ åˆ°å‡½æ•°å®šä¹‰æ—¶åˆ›å»ºçš„åŒä¸€ä¸ªåˆ—è¡¨å¯¹è±¡ä¸­ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå°±åƒæ‰€æœ‰ç”¨æˆ·å…±äº«åŒä¸€ä¸ªè´­ç‰©è½¦ä¸€æ ·ã€‚
- en: How To Avoid
  id: totrans-26
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: å¦‚ä½•é¿å…
- en: 'As a workaround, you can set `cart` to `None` and initialize the cart inside
    the function like so:'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: ä½œä¸ºè§£å†³æ–¹æ¡ˆï¼Œä½ å¯ä»¥å°† `cart` è®¾ç½®ä¸º `None`ï¼Œç„¶ååœ¨å‡½æ•°å†…éƒ¨åˆå§‹åŒ–è´­ç‰©è½¦ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š
- en: '[PRE5]'
  id: totrans-28
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: So each user now has a separate cart. ğŸ™‚
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: æ‰€ä»¥æ¯ä¸ªç”¨æˆ·ç°åœ¨éƒ½æœ‰ä¸€ä¸ªå•ç‹¬çš„è´­ç‰©è½¦ã€‚ğŸ™‚
- en: 'If you need a refresher on Python functions and function arguments, read [Python
    Function Arguments: A Definitive Guide](/2023/02/python-function-arguments-definitive-guide.html).'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚æœä½ éœ€è¦å¤ä¹  Python å‡½æ•°å’Œå‡½æ•°å‚æ•°ï¼Œå¯ä»¥é˜…è¯» [Python å‡½æ•°å‚æ•°ï¼šç»ˆææŒ‡å—](/2023/02/python-function-arguments-definitive-guide.html)ã€‚
- en: 2\. Variable Scope in Loops and Comprehensions
  id: totrans-31
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 2\. å¾ªç¯å’Œæ¨å¯¼å¼ä¸­çš„å˜é‡ä½œç”¨åŸŸ
- en: Python's scope oddities call for a tutorial of their own. But weâ€™ll look at
    one such oddity here.
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: Python çš„ä½œç”¨åŸŸæ€ªç™–éœ€è¦ä¸€ä¸ªä¸“é—¨çš„æ•™ç¨‹ã€‚ä¸è¿‡æˆ‘ä»¬å°†åœ¨è¿™é‡Œçœ‹çœ‹å…¶ä¸­ä¸€ä¸ªæ€ªç™–ã€‚
- en: 'Look at the following snippet:'
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: çœ‹ä¸€ä¸‹ä»¥ä¸‹ä»£ç ç‰‡æ®µï¼š
- en: '[PRE6]'
  id: totrans-34
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: The variable `x` is set to 10\. But `x` is also the looping variable. But weâ€™d
    assume that the looping variableâ€™s scope is limited to the for loop block, yes?
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: å˜é‡ `x` è¢«è®¾ç½®ä¸º 10ã€‚ä½†æ˜¯ `x` ä¹Ÿæ˜¯å¾ªç¯å˜é‡ã€‚æˆ‘ä»¬å‡è®¾å¾ªç¯å˜é‡çš„ä½œç”¨èŒƒå›´ä»…é™äº for å¾ªç¯å—ï¼Œå¯¹å—ï¼Ÿ
- en: 'Letâ€™s look at the output:'
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬çœ‹çœ‹è¾“å‡ºï¼š
- en: '[PRE7]'
  id: totrans-37
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: We see that `x` is now 4, the final value it takes in the loop, and not the
    initial value of 10 we set it to.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬çœ‹åˆ° `x` ç°åœ¨æ˜¯ 4ï¼Œè¿™ä¸ªå€¼æ˜¯å®ƒåœ¨å¾ªç¯ä¸­å–åˆ°çš„æœ€ç»ˆå€¼ï¼Œè€Œä¸æ˜¯æˆ‘ä»¬è®¾ç½®çš„åˆå§‹å€¼ 10ã€‚
- en: 'Now letâ€™s see what happens if we replace the for loop with a comprehension
    expression:'
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨è®©æˆ‘ä»¬çœ‹çœ‹å¦‚æœæˆ‘ä»¬å°† for å¾ªç¯æ›¿æ¢ä¸ºåˆ—è¡¨è§£æè¡¨è¾¾å¼ä¼šå‘ç”Ÿä»€ä¹ˆï¼š
- en: '[PRE8]'
  id: totrans-40
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'Here, `x` is 10, the value we set it to before the comprehension expression:'
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨è¿™é‡Œï¼Œ`x` æ˜¯ 10ï¼Œè¿™æ˜¯æˆ‘ä»¬åœ¨åˆ—è¡¨è§£æè¡¨è¾¾å¼ä¹‹å‰è®¾ç½®çš„å€¼ï¼š
- en: '[PRE9]'
  id: totrans-42
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: How To Avoid
  id: totrans-43
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: å¦‚ä½•é¿å…
- en: 'To avoid unexpected behavior: If youâ€™re using loops, ensure that you donâ€™t
    name the looping variable the same as another variable youâ€™d want to access later.'
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸ºäº†é¿å…æ„å¤–è¡Œä¸ºï¼šå¦‚æœä½ åœ¨ä½¿ç”¨å¾ªç¯æ—¶ï¼Œç¡®ä¿ä¸è¦å°†å¾ªç¯å˜é‡å‘½åä¸ºä½ ç¨åæƒ³è¦è®¿é—®çš„å…¶ä»–å˜é‡ç›¸åŒçš„åç§°ã€‚
- en: 3\. Integer Identity Quirk
  id: totrans-45
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 3\. æ•´æ•°èº«ä»½ç‰¹æ€§
- en: In Python, we use the `is` keyword for checking object identity. Meaning it
    checks whether two variables reference the same object in memory. And to check
    for equality, we use the `==` operator. Yes?
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨ Python ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ `is` å…³é”®å­—æ¥æ£€æŸ¥å¯¹è±¡èº«ä»½ã€‚è¿™æ„å‘³ç€å®ƒæ£€æŸ¥ä¸¤ä¸ªå˜é‡æ˜¯å¦å¼•ç”¨äº†å†…å­˜ä¸­çš„åŒä¸€å¯¹è±¡ã€‚è¦æ£€æŸ¥ç›¸ç­‰æ€§ï¼Œæˆ‘ä»¬ä½¿ç”¨ `==` æ“ä½œç¬¦ã€‚å¯¹å—ï¼Ÿ
- en: 'Now, start a Python REPL and run the following code:'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨ï¼Œå¯åŠ¨ä¸€ä¸ª Python REPL å¹¶è¿è¡Œä»¥ä¸‹ä»£ç ï¼š
- en: '[PRE10]'
  id: totrans-48
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: 'Now run this:'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨è¿è¡Œè¿™ä¸ªï¼š
- en: '[PRE11]'
  id: totrans-50
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: '**Wait, why does this happen?** Well, this is due to "integer caching" or "interning"
    in CPython, the standard implementation of Python.'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: '**ç­‰ç­‰ï¼Œä¸ºä»€ä¹ˆä¼šå‘ç”Ÿè¿™ç§æƒ…å†µï¼Ÿ** å¥½å§ï¼Œè¿™æ˜¯ç”±äº CPython ä¸­çš„â€œæ•´æ•°ç¼“å­˜â€æˆ–â€œé©»ç•™â€ã€‚'
- en: CPython [caches integer objects](https://stackoverflow.com/questions/15171695/whats-with-the-integer-cache-maintained-by-the-interpreter)
    in the range of -5 to 256\. **Meaning every time you use an integer within this
    range, Python will use the same object in memory.** Therefore, when you compare
    two integers within this range using the `is` keyword, the result is `True` because
    they *refer to the same object in memory*.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: CPython [ç¼“å­˜æ•´æ•°å¯¹è±¡](https://stackoverflow.com/questions/15171695/whats-with-the-integer-cache-maintained-by-the-interpreter)
    åœ¨ -5 åˆ° 256 çš„èŒƒå›´å†…ã€‚**è¿™æ„å‘³ç€æ¯æ¬¡ä½ ä½¿ç”¨è¿™ä¸ªèŒƒå›´å†…çš„æ•´æ•°æ—¶ï¼ŒPython å°†ä½¿ç”¨å†…å­˜ä¸­çš„ç›¸åŒå¯¹è±¡ã€‚** å› æ­¤ï¼Œå½“ä½ ä½¿ç”¨ `is` å…³é”®å­—æ¯”è¾ƒè¿™èŒƒå›´å†…çš„ä¸¤ä¸ªæ•´æ•°æ—¶ï¼Œç»“æœæ˜¯
    `True`ï¼Œå› ä¸ºå®ƒä»¬*æŒ‡å‘å†…å­˜ä¸­çš„ç›¸åŒå¯¹è±¡*ã€‚
- en: Thatâ€™s why `a is b` returns `True`. You can also verify this by printing out
    `id(a)` and `id(b)`.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™å°±æ˜¯ä¸ºä»€ä¹ˆ `a is b` è¿”å› `True`ã€‚ä½ ä¹Ÿå¯ä»¥é€šè¿‡æ‰“å° `id(a)` å’Œ `id(b)` æ¥éªŒè¯è¿™ä¸€ç‚¹ã€‚
- en: However, integers outside this range are not cached. And each occurrence of
    such integers creates a new object in memory.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: ä½†æ˜¯ï¼Œè¿™ä¸ªèŒƒå›´ä¹‹å¤–çš„æ•´æ•°ä¸ä¼šè¢«ç¼“å­˜ã€‚æ¯æ¬¡å‡ºç°è¿™æ ·çš„æ•´æ•°éƒ½ä¼šåœ¨å†…å­˜ä¸­åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ã€‚
- en: So when you compare two integers outside the cached range using the `is` keyword
    (yes, `x` and `y` both set to 280 in our example), the result is `False` because
    they are indeed two different objects in memory.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: æ‰€ä»¥ï¼Œå½“ä½ ä½¿ç”¨ `is` å…³é”®å­—æ¯”è¾ƒä¸¤ä¸ªèŒƒå›´ä¹‹å¤–çš„æ•´æ•°æ—¶ï¼ˆæ˜¯çš„ï¼Œåœ¨æˆ‘ä»¬çš„ç¤ºä¾‹ä¸­ `x` å’Œ `y` éƒ½è®¾ç½®ä¸º 280ï¼‰ï¼Œç»“æœæ˜¯ `False`ï¼Œå› ä¸ºå®ƒä»¬ç¡®å®æ˜¯å†…å­˜ä¸­çš„ä¸¤ä¸ªä¸åŒå¯¹è±¡ã€‚
- en: How To Avoid
  id: totrans-56
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: å¦‚ä½•é¿å…
- en: This behavior shouldnâ€™t be a problem unless you try to use the `is` for comparing
    equality of two objects. So always use the `==` operator to check if any two Python
    objects have the same value.
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: é™¤éä½ å°è¯•ä½¿ç”¨ `is` æ¥æ¯”è¾ƒä¸¤ä¸ªå¯¹è±¡çš„ç›¸ç­‰æ€§ï¼Œå¦åˆ™è¿™ç§è¡Œä¸ºä¸åº”æˆä¸ºé—®é¢˜ã€‚å› æ­¤ï¼Œæ€»æ˜¯ä½¿ç”¨ `==` æ“ä½œç¬¦æ¥æ£€æŸ¥ä»»ä½•ä¸¤ä¸ª Python å¯¹è±¡æ˜¯å¦å…·æœ‰ç›¸åŒçš„å€¼ã€‚
- en: 4\. Tuple Assignment and Mutable Objects
  id: totrans-58
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 4\. å…ƒç»„èµ‹å€¼å’Œå¯å˜å¯¹è±¡
- en: If youâ€™re familiar with built-in data structures in Python, you know that tuples
    are **immutable**. So you *cannot* modify them in place. Data structures like
    lists and dictionaries, on the other hand, are **mutable**. Meaning you *can*
    change them in place.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚æœä½ ç†Ÿæ‚‰ Python çš„å†…ç½®æ•°æ®ç»“æ„ï¼Œä½ ä¼šçŸ¥é“å…ƒç»„æ˜¯ **ä¸å¯å˜** çš„ã€‚æ‰€ä»¥ä½  *ä¸èƒ½* å°±åœ°ä¿®æ”¹å®ƒä»¬ã€‚å¦ä¸€æ–¹é¢ï¼Œåƒåˆ—è¡¨å’Œå­—å…¸è¿™æ ·çš„æ•°æ®ç»“æ„æ˜¯ **å¯å˜**
    çš„ã€‚è¿™æ„å‘³ç€ä½  *å¯ä»¥* å°±åœ°æ›´æ”¹å®ƒä»¬ã€‚
- en: '**But what about tuples that contain one or more mutable objects?**'
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: '**ä½†æ˜¯åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªå¯å˜å¯¹è±¡çš„å…ƒç»„æ€ä¹ˆåŠï¼Ÿ**'
- en: 'It''s helpful to started a Python REPL and run this simple example:'
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: å¯åŠ¨ä¸€ä¸ª Python REPL å¹¶è¿è¡Œè¿™ä¸ªç®€å•çš„ç¤ºä¾‹æ˜¯å¾ˆæœ‰å¸®åŠ©çš„ï¼š
- en: '[PRE12]'
  id: totrans-62
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: Here, the first element of the tuple is a list with two elements. We try appending
    3 to the first list and it works fine! Well, did we just modify a tuple in place?
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™é‡Œï¼Œå…ƒç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯ä¸€ä¸ªåŒ…å«ä¸¤ä¸ªå…ƒç´ çš„åˆ—è¡¨ã€‚æˆ‘ä»¬å°è¯•å‘ç¬¬ä¸€ä¸ªåˆ—è¡¨ä¸­æ·»åŠ  3ï¼Œå®ƒå·¥ä½œå¾—å¾ˆå¥½ï¼å¥½å§ï¼Œæˆ‘ä»¬åˆšåˆšå°±åœ°ä¿®æ”¹äº†ä¸€ä¸ªå…ƒç»„å—ï¼Ÿ
- en: 'Now letâ€™s try to add two more elements to the list, but this time using the
    += operator:'
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨è®©æˆ‘ä»¬å°è¯•å‘åˆ—è¡¨ä¸­æ·»åŠ ä¸¤ä¸ªå…ƒç´ ï¼Œè¿™æ¬¡ä½¿ç”¨ += æ“ä½œç¬¦ï¼š
- en: '[PRE13]'
  id: totrans-65
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: 'Yes, you get a TypeError which says the tuple object does not support item
    assignment. Which is expected. But letâ€™s check the tuple:'
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: æ˜¯çš„ï¼Œä½ ä¼šå¾—åˆ°ä¸€ä¸ª TypeErrorï¼Œè¡¨ç¤ºå…ƒç»„å¯¹è±¡ä¸æ”¯æŒé¡¹èµ‹å€¼ã€‚è¿™æ˜¯é¢„æœŸçš„ã€‚ä½†è®©æˆ‘ä»¬æ£€æŸ¥ä¸€ä¸‹å…ƒç»„ï¼š
- en: '[PRE14]'
  id: totrans-67
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: We see that elements 4 and 5 have been added to the list! Did the program just
    throw an error and succeed at the same time?
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬çœ‹åˆ°å…ƒç´  4 å’Œ 5 å·²ç»è¢«æ·»åŠ åˆ°åˆ—è¡¨ä¸­ï¼ç¨‹åºæ˜¯å¦åœ¨åŒæ—¶æŠ›å‡ºé”™è¯¯å¹¶æˆåŠŸï¼Ÿ
- en: Well the += operator internally works by calling the `__iadd__()` method which
    performs in-place addition and modifies the list in place. The assignment raises
    a TypeError exception, but the addition of elements to the end of the list has
    already succeeded. += is perhaps the sharpest corner!
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: += æ“ä½œç¬¦åœ¨å†…éƒ¨é€šè¿‡è°ƒç”¨ `__iadd__()` æ–¹æ³•æ¥æ‰§è¡Œå°±åœ°åŠ æ³•ï¼Œå¹¶åœ¨åŸåœ°ä¿®æ”¹åˆ—è¡¨ã€‚èµ‹å€¼ä¼šå¼•å‘ TypeError å¼‚å¸¸ï¼Œä½†å°†å…ƒç´ æ·»åŠ åˆ°åˆ—è¡¨æœ«å°¾å·²ç»æˆåŠŸã€‚
    += ä¹Ÿè®¸æ˜¯æœ€å°–é”çš„æ£±è§’ï¼
- en: How To Avoid
  id: totrans-70
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: å¦‚ä½•é¿å…
- en: To avoid such quirks in your program, try using tuples *only* for immutable
    collections. And avoid using mutable objects as tuple elements as much as possible.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸ºäº†é¿å…ç¨‹åºä¸­çš„è¿™ç§æ€ªç™–ï¼Œå°½é‡ *ä»…* ä½¿ç”¨å…ƒç»„æ¥å¤„ç†ä¸å¯å˜é›†åˆã€‚å°½å¯èƒ½é¿å…å°†å¯å˜å¯¹è±¡ä½œä¸ºå…ƒç»„å…ƒç´ ã€‚
- en: 5\. Shallow Copies of Mutable Objects
  id: totrans-72
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 5\. å¯å˜å¯¹è±¡çš„æµ…æ‹·è´
- en: Mutability has been a recurring topic in our discussion thus far. So hereâ€™s
    another one to wrap up this tutorial.
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: å¯å˜æ€§ä¸€ç›´æ˜¯æˆ‘ä»¬è®¨è®ºä¸­çš„ä¸€ä¸ªåå¤å‡ºç°çš„è¯é¢˜ã€‚æ‰€ä»¥è¿™æ˜¯å¦ä¸€ä¸ªæ€»ç»“æœ¬æ•™ç¨‹çš„å†…å®¹ã€‚
- en: Sometimes you may need to create independent copies of lists. But what happens
    when you create a copy using a syntax similar to `list2 = list1` where `list1`
    is the original list?
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: æœ‰æ—¶ä½ å¯èƒ½éœ€è¦åˆ›å»ºåˆ—è¡¨çš„ç‹¬ç«‹å‰¯æœ¬ã€‚ä½†æ˜¯ï¼Œå½“ä½ ä½¿ç”¨ç±»ä¼¼ `list2 = list1` çš„è¯­æ³•åˆ›å»ºå‰¯æœ¬æ—¶ï¼Œå…¶ä¸­ `list1` æ˜¯åŸå§‹åˆ—è¡¨ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ
- en: Itâ€™s a shallow copy that gets created. So it only copies the references to the
    original elements of the list. Modifying elements through the shallow copy will
    affect *both* the original list *and* the shallow copy.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™æ˜¯ä¸€ä¸ªæµ…æ‹·è´ã€‚å› æ­¤ï¼Œå®ƒä»…å¤åˆ¶äº†å¯¹åŸå§‹åˆ—è¡¨å…ƒç´ çš„å¼•ç”¨ã€‚é€šè¿‡æµ…æ‹·è´ä¿®æ”¹å…ƒç´ ä¼šå½±å“ *åŸå§‹åˆ—è¡¨* å’Œ *æµ…æ‹·è´*ã€‚
- en: 'Let''s take this example:'
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬çœ‹è¿™ä¸ªä¾‹å­ï¼š
- en: '[PRE15]'
  id: totrans-77
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: 'We see that the changes to the shallow copy also affect the original list:'
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬çœ‹åˆ°å¯¹æµ…æ‹·è´çš„ä¿®æ”¹ä¹Ÿå½±å“äº†åŸå§‹åˆ—è¡¨ï¼š
- en: '[PRE16]'
  id: totrans-79
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: 'Here, we modify the first element of the first nested list in the shallow copy:
    `shallow_copy[0][0] = 100`. But we see that the modification affects both the
    original list and the shallow copy.'
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä¿®æ”¹äº†æµ…æ‹·è´ä¸­ç¬¬ä¸€ä¸ªåµŒå¥—åˆ—è¡¨çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼š`shallow_copy[0][0] = 100`ã€‚ä½†æˆ‘ä»¬çœ‹åˆ°ä¿®æ”¹å½±å“äº†åŸå§‹åˆ—è¡¨å’Œæµ…æ‹·è´ã€‚
- en: How To Avoid
  id: totrans-81
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: å¦‚ä½•é¿å…
- en: 'To avoid this, you can create a deep copy like so:'
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸ºäº†é¿å…è¿™ç§æƒ…å†µï¼Œä½ å¯ä»¥åƒè¿™æ ·åˆ›å»ºæ·±æ‹·è´ï¼š
- en: '[PRE17]'
  id: totrans-83
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: Now, any modification to the deep copy leaves the original list unchanged.
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨ï¼Œå¯¹æ·±æ‹·è´çš„ä»»ä½•ä¿®æ”¹éƒ½ä¸ä¼šæ”¹å˜åŸå§‹åˆ—è¡¨ã€‚
- en: '[PRE18]'
  id: totrans-85
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: Wrapping Up
  id: totrans-86
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: æ€»ç»“
- en: 'And thatâ€™s a wrap! In this tutorial, we''ve explored several oddities in Python:
    from the surprising behavior of mutable defaults to the subtleties of shallow
    copying lists. This is only an introduction to Pythonâ€™s oddities and is by no
    means an exhaustive list. You can find all the code examples [on GitHub](https://github.com/balapriyac/python-basics/tree/main/common-gotchas).'
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™å°±ç»“æŸäº†ï¼åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬æ¢ç´¢äº† Python ä¸­çš„ä¸€äº›å¥‡ç‰¹ç°è±¡ï¼šä»å¯å˜é»˜è®¤å€¼çš„æ„å¤–è¡Œä¸ºåˆ°æµ…æ‹·è´åˆ—è¡¨çš„ç»†å¾®å·®åˆ«ã€‚è¿™åªæ˜¯ Python å¥‡ç‰¹ç°è±¡çš„ä¸€ä¸ªä»‹ç»ï¼Œç»ä¸æ˜¯è¯¦å°½æ— é—çš„åˆ—è¡¨ã€‚ä½ å¯ä»¥åœ¨
    [GitHub](https://github.com/balapriyac/python-basics/tree/main/common-gotchas)
    ä¸Šæ‰¾åˆ°æ‰€æœ‰çš„ä»£ç ç¤ºä¾‹ã€‚
- en: As you keep coding for longer in Pythonâ€”and understand the language betterâ€”youâ€™ll
    perhaps run into many more of these. So, keep coding, keep exploring!
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: éšç€ä½ åœ¨ Python ä¸­ç¼–ç¨‹æ—¶é—´çš„å¢åŠ â€”â€”å¹¶æ›´å¥½åœ°ç†è§£è¯­è¨€â€”â€”ä½ å¯èƒ½ä¼šé‡åˆ°æ›´å¤šè¿™æ ·çš„æƒ…å†µã€‚æ‰€ä»¥ï¼Œç»§ç»­ç¼–ç¨‹ï¼Œç»§ç»­æ¢ç´¢ï¼
- en: Oh, and let us know in the comments if youâ€™d like to read a sequel to this tutorial.
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: å“¦ï¼Œå¦‚æœä½ æƒ³è¯»è¿™ä¸ªæ•™ç¨‹çš„ç»­é›†ï¼Œè¯·åœ¨è¯„è®ºä¸­å‘Šè¯‰æˆ‘ä»¬ã€‚
- en: '**[](https://twitter.com/balawc27)**[Bala Priya C](https://www.kdnuggets.com/wp-content/uploads/bala-priya-author-image-update-230821.jpg)****
    is a developer and technical writer from India. She likes working at the intersection
    of math, programming, data science, and content creation. Her areas of interest
    and expertise include DevOps, data science, and natural language processing. She
    enjoys reading, writing, coding, and coffee! Currently, she''s working on learning
    and sharing her knowledge with the developer community by authoring tutorials,
    how-to guides, opinion pieces, and more. Bala also creates engaging resource overviews
    and coding tutorials.'
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: '**[](https://twitter.com/balawc27)**[Bala Priya C](https://www.kdnuggets.com/wp-content/uploads/bala-priya-author-image-update-230821.jpg)****
    æ˜¯æ¥è‡ªå°åº¦çš„å¼€å‘äººå‘˜å’ŒæŠ€æœ¯ä½œå®¶ã€‚å¥¹å–œæ¬¢åœ¨æ•°å­¦ã€ç¼–ç¨‹ã€æ•°æ®ç§‘å­¦å’Œå†…å®¹åˆ›ä½œçš„äº¤æ±‡ç‚¹ä¸Šå·¥ä½œã€‚å¥¹çš„å…´è¶£å’Œä¸“é•¿é¢†åŸŸåŒ…æ‹¬DevOpsã€æ•°æ®ç§‘å­¦å’Œè‡ªç„¶è¯­è¨€å¤„ç†ã€‚å¥¹å–œæ¬¢é˜…è¯»ã€å†™ä½œã€ç¼–ç¨‹å’Œå–å’–å•¡ï¼ç›®å‰ï¼Œå¥¹é€šè¿‡ç¼–å†™æ•™ç¨‹ã€æ“ä½œæŒ‡å—ã€è§‚ç‚¹æ–‡ç« ç­‰æ–¹å¼ï¼Œå­¦ä¹ å¹¶ä¸å¼€å‘è€…ç¤¾åŒºåˆ†äº«å¥¹çš„çŸ¥è¯†ã€‚Balaè¿˜åˆ›å»ºäº†å¼•äººå…¥èƒœçš„èµ„æºæ¦‚è¿°å’Œç¼–ç¨‹æ•™ç¨‹ã€‚'
- en: More On This Topic
  id: totrans-91
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: æ›´å¤šç›¸å…³è¯é¢˜
- en: '[5 Common Data Science Mistakes and How to Avoid Them](https://www.kdnuggets.com/5-common-data-science-mistakes-and-how-to-avoid-them)'
  id: totrans-92
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[5 ä¸ªå¸¸è§çš„æ•°æ®ç§‘å­¦é”™è¯¯åŠå¦‚ä½•é¿å…](https://www.kdnuggets.com/5-common-data-science-mistakes-and-how-to-avoid-them)'
- en: '[3 Crucial Challenges in Conversational AI Development and How to Avoid Them](https://www.kdnuggets.com/3-crucial-challenges-in-conversational-ai-development-and-how-to-avoid-them)'
  id: totrans-93
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[å¯¹è¯å¼ AI å¼€å‘ä¸­çš„ 3 ä¸ªå…³é”®æŒ‘æˆ˜åŠå¦‚ä½•é¿å…å®ƒä»¬](https://www.kdnuggets.com/3-crucial-challenges-in-conversational-ai-development-and-how-to-avoid-them)'
- en: '[Avoid These 5 Common Mistakes Every Novice in AI Makes](https://www.kdnuggets.com/avoid-these-5-common-mistakes-every-novice-in-ai-makes)'
  id: totrans-94
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[é¿å…è¿™äº› 5 ä¸ª AI æ–°æ‰‹å¸¸çŠ¯çš„é”™è¯¯](https://www.kdnuggets.com/avoid-these-5-common-mistakes-every-novice-in-ai-makes)'
- en: '[10 Most Common Data Quality Issues and How to Fix Them](https://www.kdnuggets.com/2022/11/10-common-data-quality-issues-fix.html)'
  id: totrans-95
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[10 ä¸ªæœ€å¸¸è§çš„æ•°æ®è´¨é‡é—®é¢˜åŠå¦‚ä½•è§£å†³](https://www.kdnuggets.com/2022/11/10-common-data-quality-issues-fix.html)'
- en: '[KDnuggets News, August 24: Implementing DBSCAN in Python â€¢ How toâ€¦](https://www.kdnuggets.com/2022/n34.html)'
  id: totrans-96
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[KDnuggets æ–°é—»ï¼Œ8æœˆ24æ—¥ï¼šåœ¨ Python ä¸­å®ç° DBSCAN â€¢ å¦‚ä½•â€¦](https://www.kdnuggets.com/2022/n34.html)'
- en: '[Common Data Problems (and Solutions)](https://www.kdnuggets.com/2022/02/common-data-problems-solutions.html)'
  id: totrans-97
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[å¸¸è§æ•°æ®é—®é¢˜ï¼ˆåŠè§£å†³æ–¹æ¡ˆï¼‰](https://www.kdnuggets.com/2022/02/common-data-problems-solutions.html)'
