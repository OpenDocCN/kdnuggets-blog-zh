# å‘é‡æ•°æ®åº“åœ¨ AI å’Œ LLM ä½¿ç”¨æ¡ˆä¾‹ä¸­çš„åº”ç”¨

> åŸæ–‡ï¼š[https://www.kdnuggets.com/vector-databases-in-ai-and-llm-use-cases](https://www.kdnuggets.com/vector-databases-in-ai-and-llm-use-cases)

![å‘é‡æ•°æ®åº“åœ¨ AI å’Œ LLM ä½¿ç”¨æ¡ˆä¾‹ä¸­çš„åº”ç”¨](../Images/819ba66755bbc22a8231bc910f0f7852.png)

ä½¿ç”¨ [Ideogram.ai](http://ideogram.ai) ç”Ÿæˆçš„å›¾åƒ

å› æ­¤ï¼Œä½ å¯èƒ½ä¼šå¬åˆ°å„ç§å‘é‡æ•°æ®åº“çš„æœ¯è¯­ã€‚æœ‰äº›äººå¯èƒ½ç†è§£è¿™äº›æœ¯è¯­ï¼Œæœ‰äº›äººåˆ™ä¸ç„¶ã€‚å¦‚æœä½ ä¸å¤ªäº†è§£ä¹Ÿæ²¡å…³ç³»ï¼Œå› ä¸ºå‘é‡æ•°æ®åº“è¿‘å¹´æ¥æ‰æˆä¸ºä¸€ä¸ªæ›´åŠ çªå‡ºçš„è¯é¢˜ã€‚

* * *

## æˆ‘ä»¬çš„å‰ä¸‰ä¸ªè¯¾ç¨‹æ¨è

![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 1\. [è°·æ­Œç½‘ç»œå®‰å…¨è¯ä¹¦](https://www.kdnuggets.com/google-cybersecurity) - å¿«é€Ÿè¿›å…¥ç½‘ç»œå®‰å…¨èŒä¸šé“è·¯ã€‚

![](../Images/e225c49c3c91745821c8c0368bf04711.png) 2\. [è°·æ­Œæ•°æ®åˆ†æä¸“ä¸šè¯ä¹¦](https://www.kdnuggets.com/google-data-analytics) - æå‡ä½ çš„æ•°æ®åˆ†ææŠ€èƒ½

![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 3\. [è°·æ­Œ IT æ”¯æŒä¸“ä¸šè¯ä¹¦](https://www.kdnuggets.com/google-itsupport) - æ”¯æŒä½ æ‰€åœ¨ç»„ç»‡çš„ IT å·¥ä½œ

* * *

å‘é‡æ•°æ®åº“å› ç”Ÿæˆå¼ AIï¼Œå°¤å…¶æ˜¯å¤§å‹è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰çš„æ™®åŠè€Œå˜å¾—è¶Šæ¥è¶Šå—æ¬¢è¿ã€‚

è®¸å¤šå¤§å‹è¯­è¨€æ¨¡å‹äº§å“ï¼Œå¦‚ GPT-4 å’Œ Geminiï¼Œé€šè¿‡ä¸ºæˆ‘ä»¬çš„è¾“å…¥æä¾›æ–‡æœ¬ç”Ÿæˆèƒ½åŠ›æ¥å¸®åŠ©æˆ‘ä»¬çš„å·¥ä½œã€‚å®é™…ä¸Šï¼Œå‘é‡æ•°æ®åº“åœ¨è¿™äº›å¤§å‹è¯­è¨€æ¨¡å‹äº§å“ä¸­æ‰®æ¼”äº†é‡è¦è§’è‰²ã€‚

ä½†æ˜¯ï¼Œå‘é‡æ•°æ®åº“æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿå®ƒä»¬åœ¨å¤§å‹è¯­è¨€æ¨¡å‹ä¸­çš„ç›¸å…³æ€§æ˜¯ä»€ä¹ˆï¼Ÿ

ä¸Šè¿°é—®é¢˜æ˜¯æˆ‘ä»¬å°†åœ¨æœ¬æ–‡ä¸­å›ç­”çš„ã€‚å¥½å§ï¼Œè®©æˆ‘ä»¬ä¸€èµ·æ¥æ¢ç´¢å®ƒä»¬å§ã€‚

# å‘é‡æ•°æ®åº“

å‘é‡æ•°æ®åº“æ˜¯ä¸€ç§ä¸“é—¨çš„æ•°æ®åº“å­˜å‚¨ï¼Œç”¨äºå­˜å‚¨ã€ç´¢å¼•å’ŒæŸ¥è¯¢å‘é‡æ•°æ®ã€‚å®ƒé€šå¸¸é’ˆå¯¹é«˜ç»´å‘é‡æ•°æ®è¿›è¡Œäº†ä¼˜åŒ–ï¼Œå› ä¸ºè¿™é€šå¸¸æ˜¯æœºå™¨å­¦ä¹ æ¨¡å‹ï¼Œç‰¹åˆ«æ˜¯å¤§å‹è¯­è¨€æ¨¡å‹çš„è¾“å‡ºã€‚

åœ¨å‘é‡æ•°æ®åº“çš„èƒŒæ™¯ä¸‹ï¼Œå‘é‡æ˜¯æ•°æ®çš„æ•°å­¦è¡¨ç¤ºã€‚æ¯ä¸ªå‘é‡ç”±è¡¨ç¤ºæ•°æ®ä½ç½®çš„æ•°å€¼ç‚¹æ•°ç»„æˆã€‚å‘é‡é€šå¸¸ç”¨äºå¤§å‹è¯­è¨€æ¨¡å‹ä¸­ï¼Œå› ä¸ºå‘é‡æ¯”æ–‡æœ¬æ•°æ®æ›´å®¹æ˜“å¤„ç†ã€‚

åœ¨å¤§å‹è¯­è¨€æ¨¡å‹ç©ºé—´ä¸­ï¼Œæ¨¡å‹å¯èƒ½ä¼šæœ‰æ–‡æœ¬è¾“å…¥ï¼Œå¹¶å°†å…¶è½¬æ¢ä¸ºè¡¨ç¤ºæ–‡æœ¬è¯­ä¹‰å’Œå¥æ³•ç‰¹å¾çš„é«˜ç»´å‘é‡ã€‚è¿™ä¸€è¿‡ç¨‹æˆ‘ä»¬ç§°ä¹‹ä¸ºåµŒå…¥ã€‚ç®€å•æ¥è¯´ï¼ŒåµŒå…¥æ˜¯å°†æ–‡æœ¬è½¬æ¢ä¸ºå¸¦æœ‰æ•°å€¼æ•°æ®çš„å‘é‡çš„è¿‡ç¨‹ã€‚

åµŒå…¥é€šå¸¸ä½¿ç”¨ä¸€ç§ç§°ä¸ºåµŒå…¥æ¨¡å‹çš„ç¥ç»ç½‘ç»œæ¨¡å‹æ¥è¡¨ç¤ºåµŒå…¥ç©ºé—´ä¸­çš„æ–‡æœ¬ã€‚

è®©æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªç¤ºä¾‹æ–‡æœ¬ï¼šâ€œæˆ‘çˆ±æ•°æ®ç§‘å­¦â€ã€‚ä½¿ç”¨ OpenAI çš„ text-embedding-3-small æ¨¡å‹è¡¨ç¤ºå®ƒä»¬ä¼šç”Ÿæˆä¸€ä¸ª 1536 ç»´çš„å‘é‡ã€‚

```py
[0.024739108979701996, -0.04105354845523834, 0.006121257785707712, -0.02210472710430622, 0.029098540544509888,...]
```

å‘é‡ä¸­çš„æ•°å­—æ˜¯æ¨¡å‹åµŒå…¥ç©ºé—´ä¸­çš„åæ ‡ã€‚å®ƒä»¬å…±åŒå½¢æˆäº†æ¥è‡ªæ¨¡å‹çš„å¥å­æ„ä¹‰çš„ç‹¬ç‰¹è¡¨ç¤ºã€‚

å‘é‡æ•°æ®åº“å°†è´Ÿè´£å­˜å‚¨è¿™äº›åµŒå…¥æ¨¡å‹è¾“å‡ºã€‚ç”¨æˆ·å¯ä»¥æ ¹æ®éœ€è¦æŸ¥è¯¢ã€ç´¢å¼•å’Œæ£€ç´¢å‘é‡ã€‚

ä¹Ÿè®¸ä»‹ç»è¶³å¤Ÿäº†ï¼Œè®©æˆ‘ä»¬è¿›å…¥æ›´æŠ€æœ¯çš„å®é™…æ“ä½œã€‚æˆ‘ä»¬å°†å°è¯•ä½¿ç”¨ä¸€ä¸ªå¼€æºå‘é‡æ•°æ®åº“ [Weaviate](https://weaviate.io/) æ¥å»ºç«‹å’Œå­˜å‚¨å‘é‡ã€‚

Weaviate æ˜¯ä¸€ä¸ªå¯æ‰©å±•çš„å¼€æºå‘é‡æ•°æ®åº“ï¼Œä½œä¸ºä¸€ä¸ªæ¡†æ¶ç”¨äºå­˜å‚¨æˆ‘ä»¬çš„å‘é‡ã€‚æˆ‘ä»¬å¯ä»¥åœ¨ Docker ç­‰å®ä¾‹ä¸­è¿è¡Œ Weaviate æˆ–ä½¿ç”¨ Weaviate Cloud Services (WCS)ã€‚

è¦å¼€å§‹ä½¿ç”¨ Weaviateï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ä»¥ä¸‹ä»£ç å®‰è£…ç›¸å…³åŒ…ï¼š

```py
pip install weaviate-client
```

ä¸ºäº†ç®€åŒ–æ“ä½œï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ WCS çš„æ²™ç®±é›†ç¾¤ä½œä¸ºæˆ‘ä»¬çš„å‘é‡æ•°æ®åº“ã€‚Weaviate æä¾›äº†ä¸€ä¸ª 14 å¤©çš„å…è´¹é›†ç¾¤ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å®ƒæ¥å­˜å‚¨å‘é‡ï¼Œè€Œæ— éœ€æ³¨å†Œä»»ä½•æ”¯ä»˜æ–¹å¼ã€‚ä¸ºæ­¤ï¼Œæ‚¨éœ€è¦é¦–å…ˆåœ¨ä»–ä»¬çš„ [WCS æ§åˆ¶å°](https://console.weaviate.cloud/signin) ä¸Šæ³¨å†Œã€‚

è¿›å…¥ WCS å¹³å°åï¼Œé€‰æ‹©åˆ›å»ºé›†ç¾¤å¹¶è¾“å…¥æ‚¨çš„ Sandbox åç§°ã€‚ç”¨æˆ·ç•Œé¢åº”å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚

![AIå’ŒLLMç”¨ä¾‹ä¸­çš„å‘é‡æ•°æ®åº“](../Images/4f9a0cb53ba4630631309397f523f2d8.png)

å›¾ç‰‡æ¥æºï¼šä½œè€…

åˆ«å¿˜äº†å¯ç”¨èº«ä»½éªŒè¯ï¼Œå› ä¸ºæˆ‘ä»¬è¿˜å¸Œæœ›é€šè¿‡ WCS API å¯†é’¥è®¿é—®è¯¥é›†ç¾¤ã€‚é›†ç¾¤å‡†å¤‡å¥½åï¼Œæ‰¾åˆ° API å¯†é’¥å’Œé›†ç¾¤ URLï¼Œæˆ‘ä»¬å°†ç”¨æ¥è®¿é—®å‘é‡æ•°æ®åº“ã€‚

ä¸€æ—¦å‡†å¤‡å¥½ï¼Œæˆ‘ä»¬å°†æ¨¡æ‹Ÿå°†ç¬¬ä¸€ä¸ªå‘é‡å­˜å‚¨åœ¨å‘é‡æ•°æ®åº“ä¸­ã€‚

å¯¹äºå‘é‡æ•°æ®åº“å­˜å‚¨ç¤ºä¾‹ï¼Œæˆ‘å°†ä½¿ç”¨ Kaggle ä¸Šçš„ [Book Collection](https://www.kaggle.com/datasets/kononenko/commonlit-texts) ç¤ºä¾‹æ•°æ®é›†ã€‚æˆ‘åªä¼šä½¿ç”¨å‰ 100 è¡Œå’Œ 3 åˆ—ï¼ˆæ ‡é¢˜ã€æè¿°ã€ç®€ä»‹ï¼‰ã€‚

```py
import pandas as pd
data = pd.read_csv('commonlit_texts.csv', nrows = 100, usecols=['title', 'description', 'intro'])
```

è®©æˆ‘ä»¬å…ˆæŠŠæ•°æ®æ”¾åœ¨ä¸€è¾¹ï¼Œè¿æ¥åˆ°æˆ‘ä»¬çš„å‘é‡æ•°æ®åº“ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ API å¯†é’¥å’Œé›†ç¾¤ URL è®¾ç½®è¿œç¨‹è¿æ¥ã€‚

```py
import weaviate
import os
import requests
import json

cluster_url = "Your Cluster URL"
wcs_api_key = "Your WCS API Key"
Openai_api_key ="Your OpenAI API Key"

client = weaviate.connect_to_wcs(
    cluster_url=cluster_url,
    auth_credentials=weaviate.auth.AuthApiKey(wcs_api_key),
    headers={
        "X-OpenAI-Api-Key": openai_api_key
    }
)
```

ä¸€æ—¦è®¾ç½®å¥½å®¢æˆ·ç«¯å˜é‡ï¼Œæˆ‘ä»¬å°†è¿æ¥åˆ° Weaviate Cloud æœåŠ¡å¹¶åˆ›å»ºä¸€ä¸ªç±»æ¥å­˜å‚¨å‘é‡ã€‚Weaviate ä¸­çš„ç±»æ˜¯æ•°æ®é›†åˆï¼Œç±»ä¼¼äºå…³ç³»æ•°æ®åº“ä¸­çš„è¡¨åã€‚

```py
import weaviate.classes as wvc

client.connect()
book_collection = client.collections.create(
    name="BookCollection",
    vectorizer_config=wvc.config.Configure.Vectorizer.text2vec_openai(),  
    generative_config=wvc.config.Configure.Generative.openai()  
)
```

åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬è¿æ¥åˆ° Weaviate é›†ç¾¤å¹¶åˆ›å»ºäº†ä¸€ä¸ª BookCollection ç±»ã€‚è¯¥ç±»å¯¹è±¡è¿˜ä½¿ç”¨äº† OpenAI text2vec åµŒå…¥æ¨¡å‹å¯¹æ–‡æœ¬æ•°æ®è¿›è¡Œå‘é‡åŒ–ï¼Œå¹¶ä½¿ç”¨ OpenAI ç”Ÿæˆæ¨¡å—ã€‚

è®©æˆ‘ä»¬å°è¯•å°†æ–‡æœ¬æ•°æ®å­˜å‚¨åˆ°å‘é‡æ•°æ®åº“ä¸­ã€‚ä¸ºæ­¤ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä»£ç ã€‚

```py
sent_to_vdb = data.to_dict(orient='records')
book_collection.data.insert_many(sent_to_vdb)
```

![AIå’ŒLLMç”¨ä¾‹ä¸­çš„å‘é‡æ•°æ®åº“](../Images/405ed56bdc827843c29d85199652e61d.png)

å›¾ç‰‡æ¥æºï¼šä½œè€…

æˆ‘ä»¬å·²ç»æˆåŠŸåœ°å°†æ•°æ®é›†å­˜å‚¨åœ¨å‘é‡æ•°æ®åº“ä¸­ï¼è¿™æœ‰å¤šç®€å•ï¼Ÿ

ç°åœ¨ï¼Œæ‚¨å¯èƒ½å¯¹å‘é‡æ•°æ®åº“ä¸ LLM çš„ä½¿ç”¨åœºæ™¯æ„Ÿåˆ°å¥½å¥‡ã€‚è¿™å°±æ˜¯æˆ‘ä»¬æ¥ä¸‹æ¥è¦è®¨è®ºçš„å†…å®¹ã€‚

# å‘é‡æ•°æ®åº“å’Œ LLM ç”¨ä¾‹

ä¸€äº› LLM å¯ä»¥ä¸å‘é‡æ•°æ®åº“ç»“åˆä½¿ç”¨çš„ç”¨ä¾‹ã€‚è®©æˆ‘ä»¬ä¸€èµ·æ¢ç´¢è¿™äº›ç”¨ä¾‹ã€‚

## è¯­ä¹‰æœç´¢

è¯­ä¹‰æœç´¢æ˜¯é€šè¿‡ä½¿ç”¨æŸ¥è¯¢çš„å«ä¹‰æ¥æœç´¢æ•°æ®ï¼Œä»¥æ£€ç´¢ç›¸å…³ç»“æœï¼Œè€Œä¸æ˜¯ä»…ä¾èµ–ä¼ ç»Ÿçš„åŸºäºå…³é”®å­—çš„æœç´¢ã€‚

è¿™ä¸ªè¿‡ç¨‹æ¶‰åŠåˆ©ç”¨æŸ¥è¯¢çš„LLMæ¨¡å‹åµŒå…¥ï¼Œå¹¶åœ¨æˆ‘ä»¬çš„çŸ¢é‡æ•°æ®åº“ä¸­è¿›è¡ŒåµŒå…¥ç›¸ä¼¼æ€§æœç´¢ã€‚

è®©æˆ‘ä»¬å°è¯•ä½¿ç”¨Weaviateæ ¹æ®ç‰¹å®šæŸ¥è¯¢æ‰§è¡Œè¯­ä¹‰æœç´¢ã€‚

```py
book_collection = client.collections.get("BookCollection")

client.connect()
response = book_collection.query.near_text(
      query="childhood story,
      limit=2
  )
```

åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œæˆ‘ä»¬å°è¯•ä½¿ç”¨Weaviateè¿›è¡Œè¯­ä¹‰æœç´¢ï¼Œä»¥æŸ¥æ‰¾ä¸æŸ¥è¯¢ç«¥å¹´æ•…äº‹å¯†åˆ‡ç›¸å…³çš„å‰ä¸¤æœ¬ä¹¦ã€‚è¯­ä¹‰æœç´¢ä½¿ç”¨æˆ‘ä»¬ä¹‹å‰è®¾ç½®çš„OpenAIåµŒå…¥æ¨¡å‹ã€‚ç»“æœå¯ä»¥åœ¨ä¸‹é¢çœ‹åˆ°ã€‚

```py
{'title': 'Act Your Age', 'description': 'A young girl is told over and over again to act her age.', 'intro': 'Colleen Archer has written for \nHighlights\n. In this short story, a young girl is told over and over again to act her age.\nAs you read, take notes on what Frances is doing when she is told to act her age. '}

{'title': 'The Anklet', 'description': 'A young woman must deal with unkind and spiteful treatment from her two older sisters.', 'intro': "Neil Philip is a writer and poet who has retold the best-known stories from \nThe Arabian Nights\n for a modern day audience. \nThe Arabian Nights\n is the English-language nickname frequently given to \nOne Thousand and One Arabian Nights\n, a collection of folk tales written and collected in the Middle East during the Islamic Golden Age of the 8th to 13th centuries. In this tale, a poor young woman must deal with mistreatment by members of her own family.\nAs you read, take notes on the youngest sister's actions and feelings."}
```

å¦‚ä½ æ‰€è§ï¼Œä¸Šè¿°ç»“æœä¸­æ²¡æœ‰ç›´æ¥æåŠç«¥å¹´æ•…äº‹ã€‚ç„¶è€Œï¼Œç»“æœä»ç„¶ä¸ä¸€ä¸ªæ—¨åœ¨å„¿ç«¥çš„æ•…äº‹å¯†åˆ‡ç›¸å…³ã€‚

## ç”Ÿæˆæœç´¢

ç”Ÿæˆæœç´¢å¯ä»¥å®šä¹‰ä¸ºè¯­ä¹‰æœç´¢çš„æ‰©å±•åº”ç”¨ã€‚ç”Ÿæˆæœç´¢ï¼Œæˆ–ç§°ä¸ºæ£€ç´¢å¢å¼ºç”Ÿæˆï¼ˆRAGï¼‰ï¼Œåˆ©ç”¨LLMæç¤ºä¸ä»çŸ¢é‡æ•°æ®åº“ä¸­æ£€ç´¢çš„æ•°æ®è¿›è¡Œè¯­ä¹‰æœç´¢ã€‚

ä½¿ç”¨RAGï¼ŒæŸ¥è¯¢æœç´¢çš„ç»“æœè¢«å¤„ç†åˆ°LLMä¸­ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ä»¥æˆ‘ä»¬æƒ³è¦çš„å½¢å¼è·å¾—ç»“æœï¼Œè€Œä¸æ˜¯åŸå§‹æ•°æ®ã€‚è®©æˆ‘ä»¬å°è¯•ä½¿ç”¨çŸ¢é‡æ•°æ®åº“è¿›è¡ŒRAGçš„ç®€å•å®ç°ã€‚

```py
response = book_collection.generate.near_text(
    query="childhood story",
    limit=2,
    grouped_task="Write a short LinkedIn post about these books."
)

print(response.generated)
```

ç»“æœå¯ä»¥åœ¨ä¸‹é¢çš„æ–‡æœ¬ä¸­çœ‹åˆ°ã€‚

```py
Excited to share two captivating short stories that explore themes of age and mistreatment. "Act Your Age" by Colleen Archer follows a young girl who is constantly told to act her age, while "The Anklet" by Neil Philip delves into the unkind treatment faced by a young woman from her older sisters. These thought-provoking tales will leave you reflecting on societal expectations and family dynamics. #ShortStories #Literature #BookRecommendations ğŸ“š
```

å¦‚ä½ æ‰€è§ï¼Œæ•°æ®å†…å®¹ä¸ä¹‹å‰ç›¸åŒï¼Œä½†ç°åœ¨å·²ç»ç”¨OpenAI LLMå¤„ç†ï¼Œä»¥æä¾›ä¸€ä¸ªç®€çŸ­çš„LinkedInå¸–å­ã€‚è¿™æ ·ï¼Œå½“æˆ‘ä»¬å¸Œæœ›ä»æ•°æ®ä¸­è·å¾—ç‰¹å®šå½¢å¼çš„è¾“å‡ºæ—¶ï¼ŒRAGéå¸¸æœ‰ç”¨ã€‚

## RAGé—®ç­”

åœ¨æˆ‘ä»¬ä¹‹å‰çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨æŸ¥è¯¢è·å–äº†æ‰€éœ€çš„æ•°æ®ï¼ŒRAGå°†è¿™äº›æ•°æ®å¤„ç†æˆé¢„æœŸçš„è¾“å‡ºã€‚

ç„¶è€Œï¼Œæˆ‘ä»¬å¯ä»¥å°†RAGåŠŸèƒ½è½¬å˜ä¸ºä¸€ä¸ªé—®ç­”å·¥å…·ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡å°†å®ƒä»¬ä¸LangChainæ¡†æ¶ç»“åˆæ¥å®ç°è¿™ä¸€ç‚¹ã€‚

é¦–å…ˆï¼Œè®©æˆ‘ä»¬å®‰è£…å¿…è¦çš„åŒ…ã€‚

```py
pip install langchain 
pip install langchain_community 
pip install langchain_openai 
```

ç„¶åï¼Œè®©æˆ‘ä»¬å°è¯•å¯¼å…¥æ‰€éœ€çš„åŒ…å¹¶åˆå§‹åŒ–å˜é‡ï¼Œä»¥ä½¿RAGé—®ç­”å·¥ä½œã€‚

```py
from langchain.chains import RetrievalQA
from langchain_community.vectorstores import Weaviate
import weaviate
from langchain_openai import OpenAIEmbeddings
from langchain_openai.llms.base import OpenAI

llm = OpenAI(openai_api_key = openai_api_key, model_name = 'gpt-3.5-turbo-instruct', temperature = 1)

embeddings = OpenAIEmbeddings(openai_api_key = openai_api_key )

client = weaviate.Client(
    url=cluster_url, auth_client_secret=weaviate.AuthApiKey(wcs_api_key)
)
```

åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œæˆ‘ä»¬è®¾ç½®äº†LLMç”¨äºæ–‡æœ¬ç”Ÿæˆã€åµŒå…¥æ¨¡å‹å’ŒWeaviateå®¢æˆ·ç«¯è¿æ¥ã€‚

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†Weaviateè¿æ¥è®¾ç½®ä¸ºçŸ¢é‡æ•°æ®åº“ã€‚

```py
weaviate_vectorstore = Weaviate(client=client, index_name='BookCollection', text_key='intro',by_text = False, embedding=embeddings)
retriever = weaviate_vectorstore.as_retriever()
```

åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œå°†Weaviateæ•°æ®åº“BookCollectionè®¾ç½®ä¸ºRAGå·¥å…·ï¼Œä»¥ä¾¿åœ¨æç¤ºæ—¶æœç´¢â€˜introâ€™ç‰¹æ€§ã€‚

ç„¶åï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ä¸‹é¢çš„ä»£ç ä»LangChainåˆ›å»ºé—®ç­”é“¾ã€‚

```py
qa_chain = RetrievalQA.from_chain_type(
    llm=llm, chain_type="stuff", retriever = retriever
)
```

ä¸€åˆ‡ç°åœ¨éƒ½å‡†å¤‡å¥½äº†ã€‚è®©æˆ‘ä»¬å°è¯•ä½¿ç”¨ä¸‹é¢çš„ä»£ç ç¤ºä¾‹è¿›è¡ŒRAGé—®ç­”ã€‚

```py
response = qa_chain.invoke(
    "Who is the writer who write about love between two goldfish?")
print(response)
```

ç»“æœæ˜¾ç¤ºåœ¨ä¸‹é¢çš„æ–‡æœ¬ä¸­ã€‚

```py
{'query': 'Who is the writer who write about love between two goldfish?', 'result': ' The writer is Grace Chua.'}
```

ä½¿ç”¨çŸ¢é‡æ•°æ®åº“ä½œä¸ºå­˜å‚¨æ‰€æœ‰æ–‡æœ¬æ•°æ®çš„åœ°æ–¹ï¼Œæˆ‘ä»¬å¯ä»¥å®ç°RAGä¸LangChainä¸€èµ·æ‰§è¡Œé—®ç­”ã€‚è¿™æœ‰å¤šæ£’ï¼Ÿ

# ç»“è®º

å‘é‡æ•°æ®åº“æ˜¯ä¸€ç§ä¸“é—¨çš„å­˜å‚¨è§£å†³æ–¹æ¡ˆï¼Œæ—¨åœ¨å­˜å‚¨ã€ç´¢å¼•å’ŒæŸ¥è¯¢å‘é‡æ•°æ®ã€‚å®ƒé€šå¸¸ç”¨äºå­˜å‚¨æ–‡æœ¬æ•°æ®ï¼Œå¹¶ä¸å¤§å‹è¯­è¨€æ¨¡å‹ï¼ˆLLMsï¼‰ç»“åˆå®æ–½ã€‚æœ¬æ–‡å°†å°è¯•è¿›è¡Œå‘é‡æ•°æ®åº“ Weaviate çš„åŠ¨æ‰‹è®¾ç½®ï¼ŒåŒ…æ‹¬è¯­ä¹‰æœç´¢ã€æ£€ç´¢å¢å¼ºç”Ÿæˆï¼ˆRAGï¼‰å’ŒåŸºäº RAG çš„é—®ç­”ç­‰ç¤ºä¾‹ç”¨ä¾‹ã€‚

**[Cornellius Yudha Wijaya](https://www.linkedin.com/in/cornellius-yudha-wijaya/)** æ˜¯ä¸€åæ•°æ®ç§‘å­¦åŠ©ç†ç»ç†å’Œæ•°æ®æ’°å†™å‘˜ã€‚åœ¨å…¨èŒå·¥ä½œäº Allianz Indonesia çš„åŒæ—¶ï¼Œä»–å–œæ¬¢é€šè¿‡ç¤¾äº¤åª’ä½“å’Œå†™ä½œåª’ä½“åˆ†äº« Python å’Œæ•°æ®æŠ€å·§ã€‚Cornellius æ¶‰çŒå¤šç§äººå·¥æ™ºèƒ½å’Œæœºå™¨å­¦ä¹ ä¸»é¢˜ã€‚

### æ›´å¤šç›¸å…³ä¸»é¢˜

+   [Python å‘é‡æ•°æ®åº“å’Œå‘é‡ç´¢å¼•ï¼šLLM åº”ç”¨çš„æ¶æ„è®¾è®¡](https://www.kdnuggets.com/2023/08/python-vector-databases-vector-indexes-architecting-llm-apps.html)

+   [NoSQL æ•°æ®åº“åŠå…¶åº”ç”¨åœºæ™¯](https://www.kdnuggets.com/2023/03/nosql-databases-cases.html)

+   [ä»€ä¹ˆæ˜¯å‘é‡æ•°æ®åº“ï¼Œå®ƒä»¬ä¸ºä½•å¯¹ LLMs é‡è¦ï¼Ÿ](https://www.kdnuggets.com/2023/06/vector-databases-important-llms.html)

+   [å¯¹å¼€æºå‘é‡æ•°æ®åº“çš„è¯šå®æ¯”è¾ƒ](https://www.kdnuggets.com/an-honest-comparison-of-open-source-vector-databases)

+   [ä½¿ç”¨å‘é‡æ•°æ®åº“è¿›è¡Œè¯­ä¹‰æœç´¢](https://www.kdnuggets.com/semantic-search-with-vector-databases)

+   [Pinecone å‘é‡æ•°æ®åº“å…¨é¢æŒ‡å—](https://www.kdnuggets.com/a-comprehensive-guide-to-pinecone-vector-databases)
